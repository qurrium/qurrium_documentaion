services:
  qurrium-docs-sphinx:
    working_dir: /build
    volumes:
      - ./build:/build
    environment:
      - PYTHONUNBUFFERED=1
    entrypoint: ["/bin/bash", "-c"]
    command:
      - |
        rm -rf /app/build
        rm -rf /build/${QURRIUM_VERSION}
        sphinx-build -b html "/app/docs" "/app/build/${QURRIUM_VERSION}"
        mv "/app/build/${QURRIUM_VERSION}" "/build/${QURRIUM_VERSION}"

    build:
      args:
        QURRIUM_VERSION: ${QURRIUM_VERSION}
        DOC_VERSION: ${DOC_VERSION}
      context: .
      dockerfile: Dockerfile
